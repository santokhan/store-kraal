<script lang="ts" setup>
import { reactive, ref } from "vue";
import QNextButton from "../layout/QNextButton.vue";
import { useFormDataStore } from "../../../../stores/FormData";

const formData: any = useFormDataStore();
const user: any = reactive({ firstname: "", lastname: "", surname: "" });
const disabled: any = ref(true);
const surname: any = ref(false);

function handleChange(e: any) {
  const { name, value } = e.target;
  user[name] = value;

  if (user.firstname && user.lastname) {
    disabled.value = false;
  }
}

function nextForm() {
  const { firstname, lastname } = user;
  formData.$patch({ user: { name: { firstname, lastname, surname } } });
  next();
}
</script>

<template>
  <form @submit.prevent="() => {}" class="space-y-6 p-5 border rounded-xl">
    <div class="space-y-3">
      <input
        type="text"
        name="firstname"
        id="firstName"
        placeholder="Legal First Name"
        @input="handleChange"
        v-model="user.firstname"
        :class="
          'block p-4 max-w-md w-full text-noom-text-900 sm:text-md rounded-lg border ' +
          'bg-gray-100 border-gray-300 '
        "
        title="Legal First Name"
      />
    </div>
    <div class="space-y-3">
      <input
        type="text"
        name="lastname"
        id="lastName"
        placeholder="Legal Last Name"
        @input="handleChange"
        v-model="user.lastname"
        :class="
          'block p-4 max-w-md w-full text-noom-text-900 sm:text-md rounded-lg border ' +
          'bg-gray-100 border-gray-300 '
        "
        title="Legal Last Name"
      />
    </div>
    <div class="flex items-center gap-2">
      <input
        type="checkbox"
        @change="
          () => {
            surname = !surname;
          }
        "
        id="differentFirstName"
        class="h-4 w-4"
      />
      <label for="differentFirstName" class="text-gray-600">
        I go by a different first name
      </label>
    </div>
    <div class="space-y-3" v-if="surname">
      <input
        type="text"
        name="surname"
        id="surName"
        placeholder="Different First Name"
        @input="handleChange"
        v-model="user.surname"
        :class="
          'block p-4 max-w-md w-full text-noom-text-900 sm:text-md rounded-lg border ' +
          'bg-gray-100 border-gray-300 '
        "
        title="Legal First Name"
      />
    </div>
    <QNextButton :nextForm="nextForm" :disabled="disabled" />
  </form>
</template>
